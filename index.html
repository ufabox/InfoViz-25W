<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Road Safety Dashboards</title>

  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
  <script src="https://unpkg.com/topojson-client@3"></script>
</head>

<body>
  <main class="dashboard">
    <nav class="tabs" aria-label="Pages">
      <button class="tab active" data-tab="collisions" type="button">
        Casualties
      </button>
      <button class="tab" data-tab="about" type="button">
        About
      </button>
    </nav>

    <!-- Collisions (was Dashboard 2) -->
    <section class="tab-content active" id="collisions">
      <div class="d2-wrap">
        <aside class="d2-sidebar">
          <div id="insightsPanel" class="insights-panel"></div>

          <div class="d2-section-title">Year</div>
          <div class="d2-note">
            Choose two years from the data. Charts show CURRENT YEAR. KPI compares CURRENT vs PRIOR.
          </div>

          <div class="d2-section-title">CURRENT YEAR</div>
          <select id="currentYearSelect" class="d2-select" aria-label="Pick current year">
            <option value="" disabled selected>Pick current year</option>
          </select>

          <div class="d2-section-title">PRIOR YEAR</div>
          <select id="priorYearSelect" class="d2-select" aria-label="Pick prior year">
            <option value="" disabled selected>Pick prior year</option>
          </select>

          <div class="d2-section-title">Select Speed Limit</div>
          <select id="speedSelect" class="d2-select" aria-label="Select speed limit">
            <option value="ALL">ALL</option>
          </select>

          <div class="d2-section-title">Select Age of Casualty Participant</div>
          <div id="ageChecklist" class="d2-checklist"></div>

          <div class="d2-section-title">Select Casualty Class</div>
          <div id="classChecklist" class="d2-checklist"></div>

          <div class="d2-section-title">Select Gender of Casualty Participant</div>
          <div id="genderChecklist" class="d2-checklist"></div>

          <div class="d2-section-title">Reset</div>
          <button id="btnReset" class="d2-btn d2-btn-wide" type="button">RESET ALL</button>
        </aside>

        <section class="d2-main">
          <div class="d2-topbar">
            <div class="d2-row d2-gap10">
              <div class="d2-muted d2-strong">Select one or more severity:</div>
              <button id="sevAll" class="d2-btn d2-btn-active" type="button">SELECT ALL</button>
              <button id="sevFatal" class="d2-btn d2-danger" type="button">FATAL</button>
              <button id="sevSerious" class="d2-btn d2-warn" type="button">SERIOUS</button>
              <button id="sevSlight" class="d2-btn d2-ok" type="button">SLIGHT</button>
            </div>
            <div class="d2-muted" id="activeFiltersLabel"></div>
          </div>

          <div class="d2-grid3">
            <div class="d2-card">
              <div class="d2-card-title">Casualties by collision severity</div>
              <div id="chartSeverity" class="d2-chart"></div>
            </div>

            <div class="d2-card">
              <div class="d2-card-title">Total casualties + % vs Prior Year</div>

              <div class="d2-kpi">
                <div class="d2-kpi-big" id="kpiTotal">—</div>
                <div class="d2-kpi-sub">
                  Δ vs prior year: <span class="d2-kpi-delta" id="kpiDelta">—</span>
                </div>
                <div class="d2-kpi-sub" id="kpiContext">—</div>
              </div>

              <div class="d2-card-title d2-mt12">Casualties by gender</div>
              <div id="chartGender" class="d2-chart d2-chart-small"></div>
            </div>

            <div class="d2-card">
              <div class="d2-card-title">Monthly accidents</div>
              <div id="chartMonthly" class="d2-chart"></div>
            </div>
          </div>

          <div class="d2-grid2">
            <div class="d2-card">
              <div class="d2-card-title">Casualties by type of vehicle</div>
              <div id="chartVehicle" class="d2-chart"></div>
            </div>

            <div class="d2-card">
              <div class="d2-card-title">Casualties map</div>
              <div id="chartMap" class="d2-chart d2-chart-map"></div>
            </div>
          </div>

          <div class="m" style="margin-top:4px">
            <span class="k">Brushing tips:</span> click bars / map to highlight; <b>Shift+click</b> multi-select; click empty area or <b>Esc</b> to clear.
          </div>
        </section>
      </div>

      <!-- Tooltip for collisions dashboard -->
      <div id="tooltip-collisions" class="d2-tooltip"></div>
    </section>

    <!-- About -->
    <section class="tab-content" id="about">
      <div class="about-wrap">
        <h2>About</h2>
        <p>
          Interactive road safety dashboards built with D3.js using UK Department for Transport (DfT) road safety data (STATS19).
        </p>

        <div class="about-grid">
          <div class="about-card">
            <h3>Group 14</h3>
            <ul>
              <li>Valentin Tian (12426893)</li>
              <li>Ildar Fatkullin (11724445)</li>
              <li>Kashir Hasnain (12350030)</li>
              <li>Doan Chau Tran (11736088)</li>

            </ul>
          </div>

          <div class="about-card">
            <h3>Links</h3>
            <ul>
              <li><a href="https://www.gov.uk/government/statistics/road-safety-data/" target="_blank" rel="noopener noreferrer">Dataset source (DfT)</a></li>
              <li><a href="https://github.com/ufabox/InfoViz-25W" target="_blank" rel="noopener noreferrer">Source code (GitHub)</a></li>
              <li><a href="https://github.com/ufabox/InfoViz-25W/blob/main/docs/Road%20Safety%20proposal%20-%20G1.pdf" target="_blank" rel="noopener noreferrer">Project proposal (PDF)</a></li>
            </ul>
          </div>

          <div class="about-card">
            <h3>Local data layout</h3>
            <p>
              This repo expects all CSV files in a <code>data</code> folder next to <code>index.html</code>.
            </p>
            <ul>
              <li><code>data/df_merged_GB_collisions_last5.csv</code></li>
            </ul>
          </div>
        </div>
      </div>
    </section>
  </main>

  <script src="casualties.js"></script>
</body>
</html>
